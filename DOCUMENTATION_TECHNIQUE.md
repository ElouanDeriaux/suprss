# Documentation Technique - SUPRSS

## Table des mati√®res
1. [Informations g√©n√©rales](#informations-g√©n√©rales)
2. [Guide de d√©ploiement](#guide-de-d√©ploiement)
3. [Justification des choix techniques](#justification-des-choix-techniques)
4. [Diagrammes UML](#diagrammes-uml)
5. [Sch√©ma de base de donn√©es](#sch√©ma-de-base-de-donn√©es)

---

## Informations g√©n√©rales

### Pr√©requis syst√®me
- **Python 3.11+** pour la g√©n√©ration de cl√©s et les outils de s√©curit√©
  - T√©l√©chargement : https://www.python.org/downloads/windows/
  - Installation rapide avec winget : `winget install Python.Python.3.12`
  - V√©rifier l'installation : `python --version`
- **Docker Desktop** install√© et d√©marr√©
  - Windows : https://docs.docker.com/desktop/windows/install/
- **Docker** >= 20.10.0 et Docker Compose >= 2.0.0 (inclus dans Docker Desktop)
- **Ports libres** : 3000 (frontend), 8000 (backend), 5432 (base de donn√©es)
- **RAM minimum** : 512 Mo
- **Espace disque** : 1 Go minimum
- **Git** (optionnel - alternative ZIP disponible)

### Variables d'environnement n√©cessaires
| Variable | Description | Comment l'obtenir | Obligatoire |
|----------|-------------|-------------------|-------------|
| `SECRET_KEY` | Cl√© secr√®te JWT (32+ caract√®res) | G√©n√©rer avec `openssl rand -hex 32` ou tout g√©n√©rateur de cl√©s | ‚úÖ |
| `GOOGLE_CLIENT_ID` | ID client OAuth Google | Console Google Cloud ‚Üí APIs & Services ‚Üí Credentials | ‚ö™ Optionnel - Am√©liore l'UX |
| `GOOGLE_CLIENT_SECRET` | Secret OAuth Google | Console Google Cloud ‚Üí APIs & Services ‚Üí Credentials | ‚ö™ Optionnel - Am√©liore l'UX |
| `GITHUB_CLIENT_ID` | ID client OAuth GitHub | GitHub Settings ‚Üí Developer settings ‚Üí OAuth Apps | ‚ö™ Optionnel - Am√©liore l'UX |
| `GITHUB_CLIENT_SECRET` | Secret OAuth GitHub | GitHub Settings ‚Üí Developer settings ‚Üí OAuth Apps | ‚ö™ Optionnel - Am√©liore l'UX |
| `SMTP_SERVER` | Serveur SMTP | smtp.gmail.com ou serveur de votre fournisseur email | ‚úÖ |
| `SMTP_PORT` | Port SMTP | 587 (TLS) ou 465 (SSL) selon le serveur | ‚úÖ |
| `SMTP_USERNAME` | Utilisateur SMTP | Votre email pour l'envoi (ex: votremail@gmail.com) | ‚úÖ |
| `SMTP_PASSWORD` | Mot de passe SMTP | **Mot de passe d'APPLICATION** Gmail (PAS le mot de passe email) | ‚úÖ |

‚ö†Ô∏è **IMPORTANT S√âCURIT√â** : 
- **Ne jamais** committer le fichier `.env` sur Git (d√©j√† dans .gitignore)
- **OBLIGATOIRE** : Utiliser un mot de passe d'APPLICATION Gmail pour SMTP (JAMAIS le mot de passe email principal)
- **G√©n√©rer** des cl√©s secr√®tes al√©atoires longues (32+ caract√®res)
- **Utiliser le Security Helper pour la protection automatique
- **Consulter** `SECURITY.md` pour les bonnes pratiques compl√®tes de gestion des secrets

### üõ°Ô∏è Security Helper - Gestion S√©curis√©e des Environnements

SUPRSS int√®gre maintenant un syst√®me de s√©curit√© avanc√© pour prot√©ger vos credentials.

#### Variables Additionnelles pour Environnements Chiffr√©s
| Variable | Description | Usage |
|----------|-------------|-------|
| `SUPRSS_MASTER_PASSWORD` | Mot de passe ma√Ætre pour d√©chiffrement | Mode production Docker |

#### Outils de S√©curit√© Int√©gr√©s
```bash
python security_helper.py setup-security     # Configuration compl√®te automatique
python security_helper.py encrypt-env        # Chiffrement du .env
python security_helper.py generate-keys      # G√©n√©ration de cl√©s s√©curis√©es
python security_helper.py check-security     # Audit de s√©curit√©
```

#### Architecture de Chiffrement
- **Algorithme** : AES-256 via Fernet (cryptographie library)
- **D√©rivation cl√©** : PBKDF2-HMAC-SHA256, 100,000 it√©rations
- **D√©chiffrement** : Automatique au d√©marrage via `env_loader.py`
- **Modes** : Interactif (prompt password) ou production (env var)

#### Guide d√©taill√© pour obtenir les cl√©s OAuth :

**Google OAuth :**
1. Aller sur https://console.cloud.google.com
2. Cr√©er un nouveau projet ou s√©lectionner un existant
3. Activer l'API Google+ 
4. Aller dans "APIs & Services" ‚Üí "Credentials"
5. Cliquer "Create Credentials" ‚Üí "OAuth client ID"
6. Choisir "Web application"
7. Ajouter `http://localhost:3000` dans "Authorized origins"
8. Ajouter `http://localhost:8000/auth/google/callback` dans "Authorized redirect URIs"

**GitHub OAuth :**
1. Aller sur https://github.com/settings/developers
2. Cliquer "New OAuth App"
3. Remplir :
   - Application name: "SUPRSS"
   - Homepage URL: http://localhost:3000
   - Authorization callback URL: http://localhost:8000/auth/github/callback

**Configuration SMTP Gmail (OBLIGATOIRE pour SUPRSS) :**

‚ö†Ô∏è **RECOMMANDATION S√âCURIS√âE** : Cr√©ez un **email d√©di√© sp√©cifiquement pour SUPRSS** (ex: `suprss.monnom@gmail.com`) au lieu d'utiliser votre email principal.

1. **Cr√©er un compte Gmail d√©di√©** pour votre application SUPRSS
2. **Activer la 2FA** sur ce nouveau compte Google
3. **Aller dans "S√©curit√©" ‚Üí "V√©rification en 2 √©tapes" ‚Üí "Mots de passe d'application"**
4. **G√©n√©rer un mot de passe d'application** pour "Courrier"
5. **Utiliser ce mot de passe d'APPLICATION** dans `SMTP_PASSWORD` - Le mot de passe est affich√© avec espaces (xxxx yyyy zzzz wwww) mais doit √™tre coll√© SANS espaces (xxxxyyyyzzzzwwww) - JAMAIS votre mot de passe email
6. **Avantages du compte d√©di√©** :
   - S√©curit√© renforc√©e (isolation des acc√®s)
   - Meilleur suivi des emails SUPRSS
   - Pas de pollution de votre bo√Æte principale
   - R√©vocation facile si n√©cessaire

---

## Guide de d√©ploiement

### T√©l√©chargement du projet

#### Option 1 : ZIP (Sans Git - Pour utilisateurs finaux)
1. Aller sur https://github.com/ElouanDeriaux/suprss
2. Cliquer **"Code"** ‚Üí **"Download ZIP"**
3. Extraire et renommer le dossier `suprss-main` en `suprss`

‚ö†Ô∏è **IMPORTANT** : Vous devez **obligatoirement** configurer un serveur SMTP pour que SUPRSS fonctionne (voir section Configuration ci-dessous).

#### Option 2 : Git Clone (Pour d√©veloppeurs)

**Installation de Git (si n√©cessaire) :**

```powershell
# Installer Git avec winget
winget install --id Git.Git -e --source winget
# Red√©marrer PowerShell apr√®s installation
```

**Si winget ne fonctionne pas :**
1. **Essayer PowerShell en tant qu'Administrateur** (clic droit ‚Üí "Ex√©cuter en tant qu'administrateur")
2. **Ou t√©l√©charger manuellement Git** :
   - Aller sur https://git-scm.com/download/win
   - T√©l√©charger la version 64-bit pour Windows
   - Ex√©cuter l'installateur et suivre les √©tapes par d√©faut
   - Red√©marrer PowerShell

**Clonage du projet :**
```powershell
git clone https://github.com/ElouanDeriaux/suprss.git
cd suprss
```

‚ö†Ô∏è **IMPORTANT** : Vous devez **obligatoirement** configurer un serveur SMTP pour que SUPRSS fonctionne (voir section Configuration ci-dessous).

### D√©ploiement avec Docker (Recommand√©)

‚öôÔ∏è **Gestion simplifi√©e avec Docker Compose** : Le projet peut √™tre enti√®rement g√©r√© avec les commandes `docker-compose up` et `docker-compose down` pour le d√©marrage et l'arr√™t.

1. **Configuration des variables d'environnement**

**√âtape 1 : Copier le fichier de configuration**
```powershell
copy .env.example .env
```

**√âtape 2 : √âditer le fichier .env**

```powershell
# Ouvrir avec le Bloc-notes
notepad .env

# Ou avec VSCode si install√©
code .env
```

**√âtape 3 : Configurer les variables obligatoires**

Modifiez les lignes suivantes dans le fichier `.env` :

```env
# OBLIGATOIRE : Cl√© secr√®te pour JWT (g√©n√©rez une cl√© s√©curis√©e)
SECRET_KEY="votre-cle-secrete-64-caracteres-minimum"

# OBLIGATOIRE : SMTP pour le syst√®me d'authentification
SMTP_SERVER="smtp.gmail.com"
SMTP_PORT="587"
SMTP_USERNAME="votre-email-suprss@gmail.com"
SMTP_PASSWORD="xxxxyyyyzzzzwwww"  # Mot de passe d'application Gmail

# OPTIONNEL : OAuth Google (pour connexion Google)
GOOGLE_CLIENT_ID="votre-google-client-id"
GOOGLE_CLIENT_SECRET="votre-google-client-secret"

# OPTIONNEL : OAuth GitHub (pour connexion GitHub)
GITHUB_CLIENT_ID="votre-github-client-id"
GITHUB_CLIENT_SECRET="votre-github-client-secret"
```

**üîë G√©n√©ration de la cl√© secr√®te :**

**G√©n√©ration de cl√© s√©curis√©e :**
```powershell
# M√©thode recommand√©e avec Python (install√© en pr√©requis)
python -c "import secrets; print(secrets.token_hex(32))"

# Alternatives PowerShell si probl√®me avec Python
Add-Type -AssemblyName System.Web; [System.Web.Security.Membership]::GeneratePassword(32, 10)

# Ou g√©n√©ration hexad√©cimale
-join ((1..64) | ForEach {'{0:X}' -f (Get-Random -Max 16)})
```

**üí° Exemple de fichier .env complet (RECOMMAND√â) :**
```env
# Configuration compl√®te pour SUPRSS
SECRET_KEY="a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"

# SMTP pour le syst√®me d'authentification (OBLIGATOIRE)
SMTP_SERVER="smtp.gmail.com"
SMTP_PORT="587"
SMTP_USERNAME="votre-email-suprss@gmail.com"  # Email d√©di√© pour SUPRSS
SMTP_PASSWORD="xxxxyyyyzzzzwwww"       # Mot de passe d'application Gmail (16 caract√®res COLL√âS)

# OAuth optionnel pour connexion Google/GitHub
# GOOGLE_CLIENT_ID=""
# GOOGLE_CLIENT_SECRET=""
# GITHUB_CLIENT_ID=""
# GITHUB_CLIENT_SECRET=""
```

**üí° Exemple de fichier .env minimal (si aucun OAuth) :**
```env
# Configuration minimale pour SUPRSS
SECRET_KEY="a1b2c3d4e5f6789012345678901234567890abcdef1234567890abcdef123456"

# SMTP pour le syst√®me d'authentification (TOUJOURS OBLIGATOIRE)
SMTP_SERVER="smtp.gmail.com"
SMTP_PORT="587"
SMTP_USERNAME="votre-email-suprss@gmail.com"
SMTP_PASSWORD="xxxxyyyyzzzzwwww"

# OAuth laiss√© vide si non utilis√©
# GOOGLE_CLIENT_ID=""
# GOOGLE_CLIENT_SECRET=""
# GITHUB_CLIENT_ID=""
# GITHUB_CLIENT_SECRET=""
```

3. **Lancement**
```powershell
# D√©marrage automatique
start.bat

# Ou directement avec Docker Compose
docker-compose up -d            # D√©marrage normal
docker-compose up --build -d    # Avec reconstruction des images
```

4. **V√©rification**
```powershell
docker-compose ps
Invoke-WebRequest http://localhost:8000/health
```

### D√©ploiement manuel (D√©veloppement)

1. **Backend Python**
```powershell
# Installation d√©pendances
pip install fastapi sqlmodel uvicorn bcrypt python-jose[cryptography] feedparser requests apscheduler bleach python-dotenv authlib httpx

# Variables d'environnement
$env:SECRET_KEY="votre-cle-secrete"
$env:GOOGLE_CLIENT_ID="votre-google-client-id"
# ... autres variables

# Lancement
uvicorn main:app --reload --port 8000
```

2. **Frontend**
```powershell
cd simple-frontend
python -m http.server 3000
```

3. **Base de donn√©es**
- SQLite : Automatique (fichier `suprss.db`)
- PostgreSQL : Configurer DATABASE_URL

### Arr√™t des services
```powershell
# Script automatique
stop.bat

# Commandes Docker Compose directes
docker-compose down     # Arr√™t normal
docker-compose down -v  # Arr√™t avec suppression des volumes
```

### Administration de la base de donn√©es

#### Suppression compl√®te de la base de donn√©es
Pour supprimer toutes les donn√©es de la base tout en conservant la structure des tables :

```powershell
# Supprimer toutes les donn√©es (PowerShell)
docker exec suprss_db psql -U suprss_user -d suprss_db -c 'TRUNCATE TABLE article, articlearchive, articlereadflag, articlestar, collection, collectionmember, collectionmessage, emailverificationcode, feed, messagereadflag, "user" CASCADE;'

# Alternative si la commande ci-dessus pose probl√®me :
docker exec -it suprss_db psql -U suprss_user -d suprss_db
# Puis dans psql, ex√©cuter :
# TRUNCATE TABLE article, articlearchive, articlereadflag, articlestar, collection, collectionmember, collectionmessage, emailverificationcode, feed, messagereadflag, "user" CASCADE;
# \q pour quitter
```

‚ö†Ô∏è **ATTENTION** : Cette commande supprime **toutes les donn√©es** de mani√®re irr√©versible.

**üí° R√©solution de probl√®mes courants :**
- Si la commande √©choue avec une erreur de guillemets, utilisez la m√©thode interactive (docker exec -it)
- Assurez-vous que le conteneur suprss_db est bien d√©marr√© : `docker-compose ps`
- Si le conteneur n'existe pas, lancez d'abord : `docker-compose up -d`

---

## Justification des choix techniques

### Langages et frameworks

#### Backend : Python + FastAPI
**Justification :**
- **Performance** : FastAPI bas√© sur Starlette (async/await natif)
- **Documentation** : G√©n√©ration automatique OpenAPI/Swagger
- **Validation** : Pydantic pour validation des donn√©es
- **√âcosyst√®me** : Librairies RSS (feedparser) et s√©curit√© (bcrypt) matures
- **Typage** : Support TypeScript-like avec type hints

#### Frontend : Vanilla JavaScript + Tailwind CSS
**Justification :**
- **Performance** : Pas de framework, chargement rapide
- **Maintenance** : Code simple, pas de d√©pendances complexes
- **Flexibilit√©** : Contr√¥le total de l'interface
- **Compatibilit√©** : Fonctionne dans tous les navigateurs modernes
- **Styling** : Tailwind pour un design coh√©rent et responsive

#### Base de donn√©es : SQLite + PostgreSQL
**Justification :**
- **SQLite** : D√©ploiement simple, pas de serveur s√©par√©
- **PostgreSQL** : Production avec haute concurrence
- **SQLModel** : ORM moderne avec validation Pydantic int√©gr√©e
- **Migration** : Support transparent des deux bases

### Librairies principales

#### S√©curit√©
- **bcrypt** : Hachage de mots de passe r√©sistant aux attaques
- **python-jose** : JWT s√©curis√©s avec algorithmes cryptographiques
- **bleach** : Sanitisation HTML contre XSS
- **authlib** : OAuth2 s√©curis√© avec Google/GitHub

#### RSS et contenus
- **feedparser** : Parser RSS/Atom robuste et universel
- **requests** : HTTP client fiable avec gestion des erreurs
- **apscheduler** : Ordonnanceur pour actualisation p√©riodique
- **httpx** : Client HTTP async pour performances

#### Interface
- **Tailwind CSS** : Framework CSS utilitaire moderne
- **Vanilla JS** : Performance maximale, pas de surcharge

---

## Diagrammes UML

### Diagramme de classes (Mod√®les de donn√©es)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      User       ‚îÇ    ‚îÇ   Collection    ‚îÇ    ‚îÇ      Feed       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§    ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ - id: int       ‚îÇ    ‚îÇ - id: int       ‚îÇ    ‚îÇ - id: int       ‚îÇ
‚îÇ - username: str ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ - user_id: int  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ - collection_id ‚îÇ
‚îÇ - email: str    ‚îÇ    ‚îÇ - name: str     ‚îÇ    ‚îÇ - title: str    ‚îÇ
‚îÇ - password_hash ‚îÇ    ‚îÇ - created_at    ‚îÇ    ‚îÇ - url: str      ‚îÇ
‚îÇ - is_2fa_active ‚îÇ    ‚îÇ - shared: bool  ‚îÇ    ‚îÇ - description   ‚îÇ
‚îÇ - theme_pref    ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ - last_updated  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                           ‚îÇ - status: bool  ‚îÇ
                                               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                                        ‚îÇ
                                               ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                               ‚îÇ     Article     ‚îÇ
                                               ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
                                               ‚îÇ - id: int       ‚îÇ
                                               ‚îÇ - feed_id: int  ‚îÇ
                                               ‚îÇ - title: str    ‚îÇ
                                               ‚îÇ - link: str     ‚îÇ
                                               ‚îÇ - content: text ‚îÇ
                                               ‚îÇ - pub_date      ‚îÇ
                                               ‚îÇ - author: str   ‚îÇ
                                               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Diagramme de s√©quence (Ajout de flux RSS)

```
Utilisateur    Dashboard     API Backend    Base de donn√©es    Parser RSS
    ‚îÇ              ‚îÇ              ‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ              ‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇ Clic "Ajouter‚îÇ              ‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇ   flux"      ‚îÇ              ‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ POST /feeds/ ‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ V√©rif. droits ‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ        Test URL RSS            ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ         Validation OK          ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ Sauvegarde    ‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ              ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇ              ‚îÇ   200 OK     ‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇ‚óÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ              ‚îÇ               ‚îÇ                ‚îÇ
    ‚îÇToast "Succ√®s"‚îÇ              ‚îÇ               ‚îÇ                ‚îÇ
```

---

## Sch√©ma de base de donn√©es

### Mod√®le Entit√©-Relation

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ      users      ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   collections   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ      feeds      ‚îÇ
‚îÇ                 ‚îÇ 1:n ‚îÇ                 ‚îÇ 1:n ‚îÇ                 ‚îÇ
‚îÇ id (PK)         ‚îÇ     ‚îÇ id (PK)         ‚îÇ     ‚îÇ id (PK)         ‚îÇ
‚îÇ username        ‚îÇ     ‚îÇ user_id (FK)    ‚îÇ     ‚îÇ collection_id   ‚îÇ
‚îÇ email           ‚îÇ     ‚îÇ name            ‚îÇ     ‚îÇ title           ‚îÇ
‚îÇ password_hash   ‚îÇ     ‚îÇ created_at      ‚îÇ     ‚îÇ url             ‚îÇ
‚îÇ is_2fa_active   ‚îÇ     ‚îÇ shared          ‚îÇ     ‚îÇ description     ‚îÇ
‚îÇ theme_preference‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ last_updated    ‚îÇ
‚îÇ created_at      ‚îÇ                             ‚îÇ active          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                                               ‚îÇ
         ‚îÇ                                               ‚îÇ 1:n
         ‚îÇ                                               ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                             ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇcollection_members‚îÇ                            ‚îÇ     articles    ‚îÇ
‚îÇ                 ‚îÇ                             ‚îÇ                 ‚îÇ
‚îÇ id (PK)         ‚îÇ                             ‚îÇ id (PK)         ‚îÇ
‚îÇ collection_id   ‚îÇ                             ‚îÇ feed_id (FK)    ‚îÇ
‚îÇ user_id (FK)    ‚îÇ                             ‚îÇ title           ‚îÇ
‚îÇ role            ‚îÇ                             ‚îÇ link            ‚îÇ
‚îÇ joined_at       ‚îÇ                             ‚îÇ content         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                             ‚îÇ published_at    ‚îÇ
                                                ‚îÇ author          ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                             ‚îÇ created_at      ‚îÇ
‚îÇ article_read_flag‚îÇ                            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ                 ‚îÇ                                       ‚îÇ
‚îÇ id (PK)         ‚îÇ                                       ‚îÇ
‚îÇ article_id (FK) ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ user_id (FK)    ‚îÇ
‚îÇ read_at         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ collection_messages   ‚îÇ   message_read   ‚îÇ     ‚îÇ article_archive ‚îÇ
‚îÇ                 ‚îÇ     ‚îÇ      _flags     ‚îÇ     ‚îÇ                 ‚îÇ
‚îÇ id (PK)         ‚îÇ     ‚îÇ                 ‚îÇ     ‚îÇ id (PK)         ‚îÇ
‚îÇ collection_id   ‚îÇ     ‚îÇ id (PK)         ‚îÇ     ‚îÇ user_id (FK)    ‚îÇ
‚îÇ user_id (FK)    ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ message_id (FK) ‚îÇ     ‚îÇ article_id      ‚îÇ
‚îÇ article_id      ‚îÇ     ‚îÇ user_id (FK)    ‚îÇ     ‚îÇ title           ‚îÇ
‚îÇ message         ‚îÇ     ‚îÇ read_at         ‚îÇ     ‚îÇ link            ‚îÇ
‚îÇ message_type    ‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îÇ content_html    ‚îÇ
‚îÇ created_at      ‚îÇ                             ‚îÇ archived_at     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                             ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Index de performance
```sql
-- Index pour les requ√™tes fr√©quentes
CREATE INDEX idx_articles_feed_id ON articles(feed_id);
CREATE INDEX idx_articles_published_at ON articles(published_at DESC);
CREATE INDEX idx_article_read_flag_user_article ON article_read_flag(user_id, article_id);
CREATE INDEX idx_collection_members_collection_user ON collection_members(collection_id, user_id);
CREATE INDEX idx_feeds_collection_id ON feeds(collection_id);
CREATE INDEX idx_collection_messages_collection ON collection_messages(collection_id, created_at);
```

### Contraintes de donn√©es
- **Mots de passe** : Minimum 8 caract√®res, majuscule, minuscule, chiffre, caract√®re sp√©cial
- **Emails** : Validation RFC 5322
- **URLs RSS** : Validation HTTP/HTTPS
- **R√¥les** : "owner", "admin", "editor", "reader"
- **Types de messages** : "message", "comment"

---

## Architecture syst√®me

### Conteneurisation Docker
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Frontend      ‚îÇ    ‚îÇ    Backend      ‚îÇ    ‚îÇ   Database      ‚îÇ
‚îÇ   (Nginx)       ‚îÇ    ‚îÇ   (FastAPI)     ‚îÇ    ‚îÇ (PostgreSQL)    ‚îÇ
‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ    ‚îÇ                 ‚îÇ
‚îÇ Port: 3000      ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Port: 8000      ‚îÇ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Port: 5432      ‚îÇ
‚îÇ Volume: html    ‚îÇ    ‚îÇ Volume: uploads ‚îÇ    ‚îÇ Volume: pgdata  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### S√©curit√©
- **Sanitisation** : Tous les contenus HTML avec bleach
- **CORS** : Configuration stricte pour production
- **JWT** : Expiration configur√©e, algorithme HS256
- **Mots de passe** : Hachage bcrypt avec salt
- **Variables d'environnement** : Secrets externalis√©s

---
*Derni√®re modification : 29 ao√ªt 2025*
